<?xml version="1.0" encoding="UTF-8"?>
<project>

  <target name="-post-compile" depends="build-ndk" />

  <target name="-pre-compile" depends="generate_benchmark_sources" />

  <target name="clean" depends="android_rules.clean">
    <exec executable="${ndk.dir}/ndk-build" failonerror="true">
      <arg value="clean"/>
    </exec>
    <delete file="${jni_src.dir}/${jni_header}" />
  </target>

  <target name="generate_benchmark_sources">
    <exec executable="pwd" />
    <exec executable="echo">
      <arg value="${codegen_script.dir}" />
      </exec>
    <exec executable="python" outputproperty="jni_classes">
          <arg value="${codegen_script.dir}/make_benchmarks.py" />
          <arg value="${jni_src.dir}/nativebenchmark.c" />
          <arg value="${gen_src.dir}" />
    </exec>
  </target>

  <target name="jni_headers">
    <javah outputFile="${jni_src.dir}/${jni_header}" classpath="bin/classes" class="${jni_classes}" />
  </target>

  <target name="build-ndk" depends="jni_headers">
    <exec executable="${ndk.dir}/ndk-build" failonerror="true"/>
  </target>

   <!-- <target name="checkbenchmarks"> -->
   <!--    <uptodate property="nochanges"> -->
   <!--       <srcfiles dir="${codegen_script.dir}" includes="**/*"/> -->
   <!--       <mapper to="applicaton.flex"/> -->
   <!--    </uptodate> -->
   <!-- </target> -->

   <!-- <target name="compile" depends="checkforchanges" unless="nochanges"> -->
   <!--    ... -->
   <!-- </target> -->

</project>

